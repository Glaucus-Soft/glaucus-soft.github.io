<!DOCTYPE html>
<html lang="es">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
	<!-- favicon -->
	<link rel="shortcut icon" type="image/png" href="http://www.glaucussoft.com/theme/images/favicon.png">
	<link rel="shortcut icon" type="image/x-icon" href="http://www.glaucussoft.com/favicon.ico">
    <!--[if lte IE 8]><script src="http://www.glaucussoft.com/theme/css/ie/html5shiv.js"></script><![endif]-->
    <script src="http://www.glaucussoft.com/theme/js/jquery.min.js"></script>
    <script src="http://www.glaucussoft.com/theme/js/jquery.dropotron.min.js"></script>
    <script src="http://www.glaucussoft.com/theme/js/skel.min.js"></script>
    <script src="http://www.glaucussoft.com/theme/js/skel-layers.min.js"></script>
    <script src="http://www.glaucussoft.com/theme/js/init.js"></script>
    <link rel="stylesheet" href="http://www.glaucussoft.com/theme/css/pygment.css" />
    <noscript>
        <link rel="stylesheet" href="http://www.glaucussoft.com/theme/css/skel.css" />
        <link rel="stylesheet" href="http://www.glaucussoft.com/theme/css/style.css" />
        <link rel="stylesheet" href="http://www.glaucussoft.com/theme/css/style-noscript.css" />
		<!-- Carousel -->
		<link rel="stylesheet" type="text/css" href="http://www.glaucussoft.com/theme/slick/slick.css"/>
		<link rel="stylesheet" type="text/css" href="http://www.glaucussoft.com/theme/slick/slick-theme.css"/>
    </noscript>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Anonymous+Pro:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css" >
    <!--[if lte IE 8]><link rel="stylesheet" href="http://www.glaucussoft.com/theme/css/ie/v8.css" /><![endif]-->
    <!--[if lte IE 9]><link rel="stylesheet" href="http://www.glaucussoft.com/theme/css/ie/v9.css" /><![endif]-->

    <title>Apache sobre SSL | Glaucus Soft </title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width">
	<meta name="google-site-verification" content="kdgqOmfjzZSRTXU4i2rtJdUs6sfs8HdMNPXCtoTBMrw" />
</head>

<body class=" loading">



    <!-- Header -->
    <header id="header" >
        <h1 class="image logo">
			<a href="http://www.glaucussoft.com"><img src="http://www.glaucussoft.com/images/logo.png" alt="" /><span>Glaucus Soft</span></a>
            <!-- <a href="http://www.glaucussoft.com">Glaucus Soft</a> -->
        </h1>
        <nav id="nav">
            <ul>
                <!-- <li class="current"><a href="index.html">Welcome</a></li> -->
				<li class="submenu">
                    <a href="#s_projects">Proyectos</a>
                    <ul>
                            <li >
                                <a href="http://www.glaucussoft.com/pages/gmountr.html">GMountR</a>
                            </li>
                            <li >
                                <a href="http://www.glaucussoft.com/pages/gshare.html">GShare</a>
                            </li>
                            <li >
                                <a href="http://www.glaucussoft.com/pages/imsoma.html">Imsoma</a>
                            </li>
                            <li >
                                <a href="http://www.glaucussoft.com/pages/monitor.html">Monitor Procesos</a>
                            </li>
                    </ul>
                </li>
                <li class="submenu">
                    <a href="http://www.glaucussoft.com/">Blog</a>
                    <ul>
                            <li class="active">
                                <a href="http://www.glaucussoft.com/category/administracion-de-sistemas.html">Administración de sistemas</a>
                            </li>
                            <li >
                                <a href="http://www.glaucussoft.com/category/mac.html">Mac</a>
                            </li>
                            <li >
                                <a href="http://www.glaucussoft.com/category/raspberry.html">Raspberry</a>
                            </li>
                            <li >
                                <a href="http://www.glaucussoft.com/category/windows.html">Windows</a>
                            </li>
                    </ul>
                </li>
				<!--
                <li><a href="#" class="button special">Sign Up</a></li>
				-->
            </ul>
        </nav>
    </header>

<!-- Main -->
<article id="main">

  <header class="special container">
		<img src="images/blog/https.png" alt="" />
    <h2>Apache sobre SSL</h2>
    <!-- add page sub title here -->
		<p>Publicado el mi. 18 enero 2017 por Glaucus Soft</p>
		<p></p>
  </header>

  <!-- One -->
    <section class="wrapper style4 container">

      <!-- Content -->
        <div class="content">
          <section>
				<!-- <a href="#" class="image feature"><img src="images/pic04.jpg" alt="" /></a> -->
				<h3>Publicado en <a href="category/administracion-de-sistemas.html">Administración de sistemas</a></h3>
				<p class="tags">
					Tags: 
						<a href="http://www.glaucussoft.com/tag/apache2.html">apache2</a>
						<a href="http://www.glaucussoft.com/tag/ubuntu.html">ubuntu</a>
						<a href="http://www.glaucussoft.com/tag/server.html">server</a>
						<a href="http://www.glaucussoft.com/tag/ssl.html">ssl</a>
						<a href="http://www.glaucussoft.com/tag/configuracion.html">configuración</a>
						<a href="http://www.glaucussoft.com/tag/https.html">https</a>
						<a href="http://www.glaucussoft.com/tag/http.html">http</a>
</p>
				<p><h2>Introducción</h2>
<p>Cuando hablamos de seguridad, en lo que a servidores de páginas web respecta, hablamos del protocolo https. Https es importante ya que nos proporciona un cifrado punto a punto (desde el servidor hasta el cliente) de las comunicaciones entre ambos, de forma que si alguien nos ataca e intercepta un paquete de red no pueda descifrarlo. Esto es útil cuando en nuestro sitio web se manejan contraseñas y credenciales de acceso susceptibles a ataques. Por ello es una medida de seguridad muy a tener en cuenta y hoy vamos a explicar como se instala en nuestros servidores, en nuestro caso usaremos Ubuntu Server.</p>
<h2>Creación de un certificado SSL autofirmado</h2>
<p>Las empresas de importantes y las grandes entidades suelen usar certificados SSL expedidos por la FNMT (Fábrica Nacional de Moneda y Timbre), que es una entidad cuyos certificados están reconocidos por los navegadores web y son oficiales. Para nuestro caso lo que pretendemos es simplemente cifrar el tráfico http por lo cual no nos hace falta solicitar dicho certificado oficial, basta con generar el nuestro de la siguiente manera</p>
<div class="highlight"><pre><span></span>sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/certificado.key -out /etc/ssl/certs/certificado.crt
</pre></div>


<p>Los rasgos más importantes son los siguientes:
<ul>
    <li><strong>-days</strong> que especifica el número de días que es válido el certificado (en nuestro caso 365 días).</li>
    <li><strong>-keyout</strong> que especifica la ruta donde se guarda el certificado.</li>
</ul></p>
<h2>Habilitar cambios en el servicio Apache2</h2>
<p>Para que nuestro servidor Apache pueda interpretar dicho certificado y usarlo debemos habilitar varios de sus modulos</p>
<div class="highlight"><pre><span></span>sudo a2enmod ssl &amp;&amp; sudo a2enmod headers
</pre></div>


<h2>Habilitar el uso de SSL en nuestro sitio web</h2>
<p>Ahora vamos a habilitar en nuestro archivo de virtualhost por defecto el uso de SSL</p>
<div class="highlight"><pre><span></span>sudo nano /etc/apache2/sites-available/default-ssl.conf
</pre></div>


<p>Y debería quedar de la siguiente manera:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;IfModule</span> <span class="err">mod_ssl.c</span><span class="nt">&gt;</span>
    <span class="nt">&lt;VirtualHost</span> <span class="err">_default_:443</span><span class="nt">&gt;</span>
        ServerAdmin tudirecciondecorreo@dominio.tld
        ServerName dominio_o_IP
        DocumentRoot /var/www/html
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
        SSLEngine on
        SSLCertificateFile /etc/ssl/certs/certificado.crt
        SSLCertificateKeyFile /etc/ssl/private/certificado.key
        <span class="nt">&lt;FilesMatch</span> <span class="err">&quot;\.(cgi|shtml|phtml|php)$&quot;</span><span class="nt">&gt;</span>
        SSLOptions +StdEnvVars
        <span class="nt">&lt;/FilesMatch&gt;</span>
        <span class="nt">&lt;Directory</span> <span class="err">/usr/lib/cgi-bin</span><span class="nt">&gt;</span>
            SSLOptions +StdEnvVars
        <span class="nt">&lt;/Directory&gt;</span>

        BrowserMatch &quot;MSIE [2-6]&quot; \
            nokeepalive ssl-unclean- shutdown \
            downgrade-1.0 force-response-
    <span class="nt">&lt;/VirtualHost&gt;</span>
<span class="nt">&lt;/IfModule&gt;</span>
</pre></div>


<h2>Redirección permanente a virtualhost SSL</h2>
<p>Ahora debemos modificar nuestro archivo de virtualhost por defecto para que requiera siempre el uso de SSL</p>
<div class="highlight"><pre><span></span>sudo nano /etc/apache2/sites-available/000-default.conf
</pre></div>


<p>Y debemos añadir la línea</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;VirtualHost</span> <span class="err">*:80</span><span class="nt">&gt;</span>
    . . .
    Redirect permanent &quot;/&quot; &quot;https://dominio_o_IP&quot;
    . . .
<span class="nt">&lt;/VirtualHost&gt;</span>
</pre></div>


<h2>Prueba en un navegador web</h2>
<p>Ya solo nos quedaría reiniciar el servicio de Apache2 para aplicar todos los cambios</p>
<div class="highlight"><pre><span></span>sudo service apache2 restart
</pre></div>


<p>Y en un navegador web cualquiera introducimos la siguiente dirección</p>
<div class="highlight"><pre><span></span>https://dominio_o_IP
</pre></div>


<h2>Observaciones</h2>
<p>Hemos habilitado el uso de HTTP sobre SSL en el virtualhost por defecto de Apache2. Si necesitáis usar virtualhost distintos o no sabéis crear uno pasaos por nuestro tutorial <strong>Crear VirtualHost en Apache</strong></p></p>
          </section>
        </div>

    </section>

    <!-- Two -->
    <!--     <section class="wrapper style1 container special">
        <div class="row">
          <div class="4u">

            <section>
			<a class="enlace-sin-decoracion" href="http://www.glaucussoft.com/apache-sobre-ssl.html"><img class="miniatura_imagen_pagina" src="/images/blog/https.png" alt="" /></a>
              <header>
                <a href="http://www.glaucussoft.com/apache-sobre-ssl.html" rel='bookmark'><h3>Apache sobre SSL</h3></a>
              </header>
			  <p><p>Configurar servicio Apache para que funcione sobre ssl (https)&reg;</p></p>
            </section>

          </div>
          <div class="4u">

            <section>
			<a class="enlace-sin-decoracion" href="http://www.glaucussoft.com/macos-habla.html"><img class="miniatura_imagen_pagina" src="/images/blog/mac-habla.png" alt="" /></a>
              <header>
                <a href="http://www.glaucussoft.com/macos-habla.html" rel='bookmark'><h3>Hacer que tu mac hable</h3></a>
              </header>
			  <p><p>Hacer que tu mac hable</p></p>
            </section>

          </div>
          <div class="4u">

            <section>
			<a class="enlace-sin-decoracion" href="http://www.glaucussoft.com/musica-airplay-raspberry-pi.html"><img class="miniatura_imagen_pagina" src="/images/blog/raspi-shairport.png" alt="" /></a>
              <header>
                <a href="http://www.glaucussoft.com/musica-airplay-raspberry-pi.html" rel='bookmark'><h3>Reproductor de música AirPlay con raspberry pi</h3></a>
              </header>
			  <p><p>Reproductor de música AirPlay con raspberry pi&reg;</p></p>
            </section>

          </div>
          <div class="4u">

            <section>
			<a class="enlace-sin-decoracion" href="http://www.glaucussoft.com/configurar-red-raspberry-pi-server.html"><img class="miniatura_imagen_pagina" src="/images/blog/raspberry-pi-logo.png" alt="" /></a>
              <header>
                <a href="http://www.glaucussoft.com/configurar-red-raspberry-pi-server.html" rel='bookmark'><h3>Configurar red raspberry pi server</h3></a>
              </header>
			  <p><p>Configurar la conexión a red wifi en raspberry pi por línea de comandos&reg;</p></p>
            </section>

          </div>
        </div>
    </section> -->

  </article>



<!-- Footer -->
<footer id="footer">

    <ul class="icons">
        <li>
          <a href="https://twitter.com/GlaucusSoft" target="_blank" class="icon circle fa fa-twitter"><span class="label">twitter</span></a>
        </li>
        <li>
          <a href="https://www.facebook.com/Glaucus-Soft-262164514127427/" target="_blank" class="icon circle fa fa-facebook"><span class="label">facebook</span></a>
        </li>
    </ul>

    <span class="copyright">&copy; Glaucus Soft. Todos los derechos reservados. Diseño basado en: <a href="https://html5up.net/twenty">HTML5 UP - Twenty</a>.</span>

</footer>
</body>
</html>